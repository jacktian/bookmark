angular.module("bookmark.controller",[]).controller("bookmarkController",["$scope","API","$timeout",function(e,o,t){e.wallScroll=!1,e.scrollText="添加书签",e.showForm=function(){e.wallScroll=!e.wallScroll,"添加书签"==e.scrollText?e.scrollText="回到导航":e.scrollText="添加书签"},e.flip=!1,e.presentCategories=!1,e.newCategory={name:""};var r;e.showCategories=function(){t.cancel(r),e.presentCategories=!0},e.hideCategories=function(){r=t(function(){e.presentCategories=!1},200)},e.selectCategory=function(o){var t={};angular.copy(o,t),e.newCategory=t,angular.element("#newCategory").focus()},e.removeCategory=function(t){e.showCategories(),o.Category.remove({categoryId:t}).$promise.then(function(o){20==o.errorCode?angular.forEach(e.categories,function(o,r){o.id==t&&e.categories.splice(r,1)}):alert(o.errorMsg)}).catch(function(){alert("fail to delete category")})},e.flipToCategory=function(){e.flip=!0,e.newCategory={name:""}},e.addOrEditCategory=function(){e.newCategory.name?(e.newCategory.id>0?o.Category.update({categoryId:e.newCategory.id},{name:e.newCategory.name}).$promise.then(function(o){20==o.errorCode&&(angular.forEach(e.categories,function(o,t){o.id===e.newCategory.id&&o.name!==e.newCategory.name&&(o.name=e.newCategory.name)}),e.newCategory={name:""})}).catch(function(){alert("更新分类失败")}):o.Category.save({name:e.newCategory.name}).$promise.then(function(o){20==o.errorCode?(e.categories.push(o.data),e.newCategory={name:""}):alert(o.errorMsg)}).catch(function(){alert("更新分类失败")}),angular.element("#newCategory").focus()):(e.flip=!1,e.presentCategories=!1)},e.form={element:"#bookmarkModal",url:"",description:"",category:"",open:function(){angular.element(this.element).css("display","block"),angular.element(this.element+">.modal").removeClass("close"),angular.element(this.element+">.modal").addClass("open")},close:function(){angular.element(this.element+">.modal").removeClass("open"),angular.element(this.element+">.modal").addClass("close"),t(function(){angular.element(this.element).css("display","none")}.bind(this),200)},reset:function(){this.url="",this.description="",this.category=""},submit:function(t){o.Bookmark.save({url:this.url,description:this.description,category:this.category}).$promise.then(function(o){if(20==o.errorCode)return e.urls.unshift(o.data),this.reset(),this.close(),o.data}.bind(this)).then(function(t){console.log(t);var r=t.id;o.Url.get({url:t.url,bookmarkId:r}).$promise.then(function(o){20==o.errorCode?angular.forEach(e.urls,function(t,a){t.id==r&&(e.urls[a].icon=o.data.icon,e.urls[a].title=o.data.title)}):alert(o.errorMsg)})}).catch(function(){alert("fail to add bookmark")})}},e.urls=[],o.Bookmark.get().$promise.then(function(o){20==o.errorCode&&(e.urls=o.data)}).catch(function(){alert("fail to get bookmark")}),e.categories=[],o.Category.get().$promise.then(function(o){20==o.errorCode&&(e.categories=o.data)}).catch(function(){alert("fail to get category")}),e.addCount=function(e){o.Bookmark.count({id:e})}}]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJvb2ttYXJrL2NvbnRyb2xsZXJzLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJjb250cm9sbGVyIiwiJHNjb3BlIiwiQVBJIiwiJHRpbWVvdXQiLCJ3YWxsU2Nyb2xsIiwic2Nyb2xsVGV4dCIsInNob3dGb3JtIiwiZmxpcCIsInByZXNlbnRDYXRlZ29yaWVzIiwibmV3Q2F0ZWdvcnkiLCJuYW1lIiwidGltZXIiLCJzaG93Q2F0ZWdvcmllcyIsImNhbmNlbCIsImhpZGVDYXRlZ29yaWVzIiwic2VsZWN0Q2F0ZWdvcnkiLCJjYXRlZ29yeSIsInRtcCIsImNvcHkiLCJlbGVtZW50IiwiZm9jdXMiLCJyZW1vdmVDYXRlZ29yeSIsImNJZCIsIkNhdGVnb3J5IiwicmVtb3ZlIiwiY2F0ZWdvcnlJZCIsIiRwcm9taXNlIiwidGhlbiIsImRhdGEiLCJlcnJvckNvZGUiLCJmb3JFYWNoIiwiY2F0ZWdvcmllcyIsIm8iLCJpIiwiaWQiLCJzcGxpY2UiLCJhbGVydCIsImVycm9yTXNnIiwiY2F0Y2giLCJmbGlwVG9DYXRlZ29yeSIsImFkZE9yRWRpdENhdGVnb3J5IiwidXBkYXRlIiwic2F2ZSIsInB1c2giLCJmb3JtIiwidXJsIiwiZGVzY3JpcHRpb24iLCJvcGVuIiwidGhpcyIsImNzcyIsInJlbW92ZUNsYXNzIiwiYWRkQ2xhc3MiLCJjbG9zZSIsImJpbmQiLCJyZXNldCIsInN1Ym1pdCIsImV2ZW50IiwiQm9va21hcmsiLCJ1cmxzIiwidW5zaGlmdCIsImNvbnNvbGUiLCJsb2ciLCJib29rbWFya0lkIiwiVXJsIiwiZ2V0IiwiaWNvbiIsInRpdGxlIiwiYWRkQ291bnQiLCJjb3VudCJdLCJtYXBwaW5ncyI6IkFBQUFBLFFBQVFDLE9BQU8sMEJBQ2RDLFdBQVcsc0JBQXNCLFNBQVMsTUFBTSxXQUFXLFNBQVNDLEVBQU9DLEVBQUlDLEdBQy9FRixFQUFPRyxZQUFXLEVBQ2xCSCxFQUFPSSxXQUFXLE9BQ2xCSixFQUFPSyxTQUFTLFdBQ2ZMLEVBQU9H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Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdib29rbWFyay5jb250cm9sbGVyJyxbXSlcclxuLmNvbnRyb2xsZXIoJ2Jvb2ttYXJrQ29udHJvbGxlcicsWyckc2NvcGUnLCdBUEknLCckdGltZW91dCcsZnVuY3Rpb24oJHNjb3BlLEFQSSwkdGltZW91dCl7XHJcblx0JHNjb3BlLndhbGxTY3JvbGw9ZmFsc2U7XHJcblx0JHNjb3BlLnNjcm9sbFRleHQ9XCLmt7vliqDkuabnrb5cIjtcclxuXHQkc2NvcGUuc2hvd0Zvcm09ZnVuY3Rpb24oKXtcclxuXHRcdCRzY29wZS53YWxsU2Nyb2xsPSEkc2NvcGUud2FsbFNjcm9sbDtcclxuXHRcdGlmKCRzY29wZS5zY3JvbGxUZXh0PT1cIua3u+WKoOS5puetvlwiKXtcclxuXHRcdFx0JHNjb3BlLnNjcm9sbFRleHQ9XCLlm57liLDlr7zoiKpcIjtcclxuXHRcdH1lbHNle1xyXG5cdFx0XHQkc2NvcGUuc2Nyb2xsVGV4dD1cIua3u+WKoOS5puetvlwiO1xyXG5cdFx0fVxyXG5cdH07XHJcblx0JHNjb3BlLmZsaXA9ZmFsc2U7XHJcblx0Ly8g5YiG57G75LiL5ouJ57yW6L6R5o6n5Lu2XHJcblx0JHNjb3BlLnByZXNlbnRDYXRlZ29yaWVzPWZhbHNlO1xyXG5cdCRzY29wZS5uZXdDYXRlZ29yeT17bmFtZTonJ307XHJcblx0dmFyIHRpbWVyO1xyXG5cdCRzY29wZS5zaG93Q2F0ZWdvcmllcz1mdW5jdGlvbigpe1xyXG5cdFx0JHRpbWVvdXQuY2FuY2VsKHRpbWVyKTtcclxuXHRcdCRzY29wZS5wcmVzZW50Q2F0ZWdvcmllcz10cnVlO1xyXG5cdH07XHJcblx0JHNjb3BlLmhpZGVDYXRlZ29yaWVzPWZ1bmN0aW9uKCl7XHJcblx0XHR0aW1lcj0kdGltZW91dChmdW5jdGlvbigpe1xyXG5cdFx0XHQkc2NvcGUucHJlc2VudENhdGVnb3JpZXM9ZmFsc2U7XHJcblx0XHR9LDIwMCk7XHJcblx0fTtcclxuXHQkc2NvcGUuc2VsZWN0Q2F0ZWdvcnk9ZnVuY3Rpb24oY2F0ZWdvcnkpe1xyXG5cdFx0dmFyIHRtcD17fTtcclxuXHRcdGFuZ3VsYXIuY29weShjYXRlZ29yeSx0bXApO1xyXG5cdFx0JHNjb3BlLm5ld0NhdGVnb3J5PXRtcDtcclxuXHRcdGFuZ3VsYXIuZWxlbWVudChcIiNuZXdDYXRlZ29yeVwiKS5mb2N1cygpO1xyXG5cdH07XHJcblx0JHNjb3BlLnJlbW92ZUNhdGVnb3J5PWZ1bmN0aW9uKGNJZCl7XHJcblx0XHQkc2NvcGUuc2hvd0NhdGVnb3JpZXMoKTtcclxuXHRcdEFQSS5DYXRlZ29yeS5yZW1vdmUoe2NhdGVnb3J5SWQ6Y0lkfSlcclxuXHRcdC4kcHJvbWlzZS50aGVuKGZ1bmN0aW9uKGRhdGEpe1xyXG5cdFx0XHRpZihkYXRhLmVycm9yQ29kZT09MjApe1xyXG5cdFx0XHRcdGFuZ3VsYXIuZm9yRWFjaCgkc2NvcGUuY2F0ZWdvcmllcyxmdW5jdGlvbihvLGkpe1xyXG5cdFx0XHRcdFx0aWYoby5pZD09Y0lkKXtcclxuXHRcdFx0XHRcdFx0JHNjb3BlLmNhdGVnb3JpZXMuc3BsaWNlKGksMSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1lbHNle1xyXG5cdFx0XHRcdGFsZXJ0KGRhdGEuZXJyb3JNc2cpO1xyXG5cdFx0XHR9XHJcblx0XHR9KVxyXG5cdFx0LmNhdGNoKGZ1bmN0aW9uKCl7XHJcblx0XHRcdGFsZXJ0KCdmYWlsIHRvIGRlbGV0ZSBjYXRlZ29yeScpO1xyXG5cdFx0fSk7XHJcblx0fTtcclxuXHQkc2NvcGUuZmxpcFRvQ2F0ZWdvcnk9ZnVuY3Rpb24oKXtcclxuXHRcdCRzY29wZS5mbGlwPXRydWU7XHJcblx0XHQkc2NvcGUubmV3Q2F0ZWdvcnk9e25hbWU6Jyd9O1xyXG5cdH07XHJcblx0JHNjb3BlLmFkZE9yRWRpdENhdGVnb3J5PWZ1bmN0aW9uKCl7XHJcblx0XHRpZigkc2NvcGUubmV3Q2F0ZWdvcnkubmFtZSl7XHJcblx0XHRcdGlmKCRzY29wZS5uZXdDYXRlZ29yeS5pZD4wKXsvL+e8lui+keWIhuexu1xyXG5cdFx0XHRcdEFQSS5DYXRlZ29yeS51cGRhdGUoe2NhdGVnb3J5SWQ6JHNjb3BlLm5ld0NhdGVnb3J5LmlkfSx7bmFtZTokc2NvcGUubmV3Q2F0ZWdvcnkubmFtZX0pXHJcblx0XHRcdFx0LiRwcm9taXNlLnRoZW4oZnVuY3Rpb24oZGF0YSl7XHJcblx0XHRcdFx0XHRpZihkYXRhLmVycm9yQ29kZT09MjApe1xyXG5cdFx0XHRcdFx0XHRhbmd1bGFyLmZvckVhY2goJHNjb3BlLmNhdGVnb3JpZXMsZnVuY3Rpb24obyxpKXtcclxuXHRcdFx0XHRcdFx0XHRpZihvLmlkPT09JHNjb3BlLm5ld0NhdGVnb3J5LmlkICYmIG8ubmFtZSE9PSRzY29wZS5uZXdDYXRlZ29yeS5uYW1lKXtcclxuXHRcdFx0XHRcdFx0XHRcdG8ubmFtZT0kc2NvcGUubmV3Q2F0ZWdvcnkubmFtZTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHQkc2NvcGUubmV3Q2F0ZWdvcnk9e25hbWU6Jyd9O1xyXG5cdFx0XHRcdFx0fWVsc2V7XHJcblx0XHRcdFx0XHRcdC8vIGFsZXJ0KGRhdGEuZXJyb3JNc2cpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pXHJcblx0XHRcdFx0LmNhdGNoKGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0XHRhbGVydCgn5pu05paw5YiG57G75aSx6LSlJyk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1lbHNle1xyXG5cdFx0XHRcdEFQSS5DYXRlZ29yeS5zYXZlKHtuYW1lOiRzY29wZS5uZXdDYXRlZ29yeS5uYW1lfSlcclxuXHRcdFx0XHQuJHByb21pc2UudGhlbihmdW5jdGlvbihkYXRhKXtcclxuXHRcdFx0XHRcdGlmKGRhdGEuZXJyb3JDb2RlPT0yMCl7XHJcblx0XHRcdFx0XHRcdCRzY29wZS5jYXRlZ29yaWVzLnB1c2goZGF0YS5kYXRhKTtcclxuXHRcdFx0XHRcdFx0JHNjb3BlLm5ld0NhdGVnb3J5PXtuYW1lOicnfTtcclxuXHRcdFx0XHRcdH1lbHNle1xyXG5cdFx0XHRcdFx0XHRhbGVydChkYXRhLmVycm9yTXNnKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KVxyXG5cdFx0XHRcdC5jYXRjaChmdW5jdGlvbigpe1xyXG5cdFx0XHRcdFx0YWxlcnQoJ+abtOaWsOWIhuexu+Wksei0pScpO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHRcdGFuZ3VsYXIuZWxlbWVudChcIiNuZXdDYXRlZ29yeVwiKS5mb2N1cygpO1xyXG5cdFx0fWVsc2V7XHJcblx0XHRcdCRzY29wZS5mbGlwPWZhbHNlO1xyXG5cdFx0XHQkc2NvcGUucHJlc2VudENhdGVnb3JpZXM9ZmFsc2U7XHJcblx0XHR9XHJcblx0XHRcclxuXHJcblx0fTtcclxuXHJcblx0JHNjb3BlLmZvcm09e1xyXG5cdFx0ZWxlbWVudDogJyNib29rbWFya01vZGFsJyxcclxuXHRcdHVybDpcIlwiLFxyXG5cdFx0ZGVzY3JpcHRpb246XCJcIixcclxuXHRcdGNhdGVnb3J5OlwiXCIsXHJcblx0XHRvcGVuOmZ1bmN0aW9uKCl7XHJcblx0XHRcdGFuZ3VsYXIuZWxlbWVudCh0aGlzLmVsZW1lbnQpLmNzcygnZGlzcGxheScsJ2Jsb2NrJyk7XHJcblx0XHRcdGFuZ3VsYXIuZWxlbWVudCh0aGlzLmVsZW1lbnQrXCI+Lm1vZGFsXCIpLnJlbW92ZUNsYXNzKCdjbG9zZScpO1xyXG5cdFx0XHRhbmd1bGFyLmVsZW1lbnQodGhpcy5lbGVtZW50K1wiPi5tb2RhbFwiKS5hZGRDbGFzcygnb3BlbicpO1xyXG5cdFx0fSxcclxuXHRcdGNsb3NlOmZ1bmN0aW9uKCl7XHJcblx0XHRcdGFuZ3VsYXIuZWxlbWVudCh0aGlzLmVsZW1lbnQrXCI+Lm1vZGFsXCIpLnJlbW92ZUNsYXNzKCdvcGVuJyk7XHJcblx0XHRcdGFuZ3VsYXIuZWxlbWVudCh0aGlzLmVsZW1lbnQrXCI+Lm1vZGFsXCIpLmFkZENsYXNzKCdjbG9zZScpO1xyXG5cdFx0XHQkdGltZW91dChmdW5jdGlvbigpe1xyXG5cdFx0XHRcdGFuZ3VsYXIuZWxlbWVudCh0aGlzLmVsZW1lbnQpLmNzcygnZGlzcGxheScsJ25vbmUnKTtcclxuXHRcdFx0fS5iaW5kKHRoaXMpLDIwMCk7IFxyXG5cdFx0fSxcclxuXHRcdHJlc2V0OmZ1bmN0aW9uKCl7XHJcblx0XHRcdHRoaXMudXJsPVwiXCI7XHJcblx0XHRcdHRoaXMuZGVzY3JpcHRpb249XCJcIjtcclxuXHRcdFx0dGhpcy5jYXRlZ29yeT1cIlwiO1xyXG5cdFx0fSxcclxuXHRcdHN1Ym1pdDpmdW5jdGlvbihldmVudCl7XHJcblx0XHRcdEFQSS5Cb29rbWFyay5zYXZlKHt1cmw6dGhpcy51cmwsZGVzY3JpcHRpb246dGhpcy5kZXNjcmlwdGlvbixjYXRlZ29yeTp0aGlzLmNhdGVnb3J5fSlcclxuXHRcdFx0LiRwcm9taXNlLnRoZW4oZnVuY3Rpb24oZGF0YSl7XHJcblx0XHRcdFx0aWYoZGF0YS5lcnJvckNvZGU9PTIwKXtcclxuXHRcdFx0XHRcdCRzY29wZS51cmxzLnVuc2hpZnQoZGF0YS5kYXRhKTtcclxuXHRcdFx0XHRcdHRoaXMucmVzZXQoKTtcclxuXHRcdFx0XHRcdHRoaXMuY2xvc2UoKTtcclxuXHRcdFx0XHRcdHJldHVybiBkYXRhLmRhdGE7XHJcblx0XHRcdFx0fWVsc2V7XHJcblx0XHRcdFx0XHQvLyBhbGVydChkYXRhLmVycm9yTXNnKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0uYmluZCh0aGlzKSlcclxuXHRcdFx0LnRoZW4oZnVuY3Rpb24oZGF0YSl7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coZGF0YSk7XHJcblx0XHRcdFx0dmFyIGJvb2ttYXJrSWQ9ZGF0YS5pZDtcclxuXHRcdFx0XHRBUEkuVXJsLmdldCh7dXJsOmRhdGEudXJsLGJvb2ttYXJrSWQ6Ym9va21hcmtJZH0pXHJcblx0XHRcdFx0LiRwcm9taXNlLnRoZW4oZnVuY3Rpb24oZGF0YSl7XHJcblx0XHRcdFx0XHRpZihkYXRhLmVycm9yQ29kZT09MjApe1xyXG5cdFx0XHRcdFx0XHRhbmd1bGFyLmZvckVhY2goJHNjb3BlLnVybHMsZnVuY3Rpb24obyxpKXtcclxuXHRcdFx0XHRcdFx0XHRpZihvLmlkPT1ib29rbWFya0lkKXtcclxuXHRcdFx0XHRcdFx0XHRcdCRzY29wZS51cmxzW2ldLmljb249ZGF0YS5kYXRhLmljb247XHJcblx0XHRcdFx0XHRcdFx0XHQkc2NvcGUudXJsc1tpXS50aXRsZT1kYXRhLmRhdGEudGl0bGU7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdH1lbHNle1xyXG5cdFx0XHRcdFx0XHRhbGVydChkYXRhLmVycm9yTXNnKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fSlcclxuXHRcdFx0LmNhdGNoKGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0YWxlcnQoJ2ZhaWwgdG8gYWRkIGJvb2ttYXJrJyk7XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdH07XHJcblx0Ly8g6I635Y+W5omA5pyJ5Lmm562+XHJcblx0JHNjb3BlLnVybHM9W107XHJcblx0QVBJLkJvb2ttYXJrLmdldCgpXHJcblx0LiRwcm9taXNlLnRoZW4oZnVuY3Rpb24oZGF0YSl7XHJcblx0XHRpZihkYXRhLmVycm9yQ29kZT09MjApe1xyXG5cdFx0XHQkc2NvcGUudXJscz1kYXRhLmRhdGE7XHJcblx0XHR9ZWxzZXtcclxuXHRcdFx0Ly8gYWxlcnQoZGF0YS5lcnJvck1zZyk7XHJcblx0XHR9XHJcblx0fSlcclxuXHQuY2F0Y2goZnVuY3Rpb24oKXtcclxuXHRcdGFsZXJ0KCdmYWlsIHRvIGdldCBib29rbWFyaycpO1xyXG5cdH0pO1xyXG5cdC8vIOiOt+WPluWIhuexu1xyXG5cdCRzY29wZS5jYXRlZ29yaWVzPVtdO1xyXG5cdEFQSS5DYXRlZ29yeS5nZXQoKVxyXG5cdC4kcHJvbWlzZS50aGVuKGZ1bmN0aW9uKGRhdGEpe1xyXG5cdFx0aWYoZGF0YS5lcnJvckNvZGU9PTIwKXtcclxuXHRcdFx0JHNjb3BlLmNhdGVnb3JpZXM9ZGF0YS5kYXRhO1xyXG5cdFx0fWVsc2V7XHJcblx0XHRcdC8vIGFsZXJ0KGRhdGEuZXJyb3JNc2cpO1xyXG5cdFx0fVxyXG5cdH0pXHJcblx0LmNhdGNoKGZ1bmN0aW9uKCl7XHJcblx0XHRhbGVydCgnZmFpbCB0byBnZXQgY2F0ZWdvcnknKTtcclxuXHR9KTtcclxuXHQvLyDlop7liqDkuabnrb7ngrnlh7vmlbBcclxuXHQkc2NvcGUuYWRkQ291bnQ9ZnVuY3Rpb24oYm9va21hcmtJZCl7XHJcblx0XHRBUEkuQm9va21hcmsuY291bnQoe2lkOmJvb2ttYXJrSWR9KTtcclxuXHR9O1xyXG59XSk7Il19
